<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Young Internet - Simple</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: white; padding: 20px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .username { color: #1da1f2; font-weight: bold; margin-bottom: 10px; }
        .category { color: #657786; font-size: 0.9em; }
        .followers { color: #14171a; font-weight: bold; }
        .search { padding: 10px; margin: 10px 0; font-size: 16px; width: 300px; }
        #status { padding: 20px; text-align: center; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>The Young Internet - Simple Version</h1>
        <input type="text" id="searchInput" class="search" placeholder="Search accounts..." />
        <div id="status">Loading...</div>
        <div id="results"></div>
    </div>

    <script>
        let allData = [];
        let currentOffset = 0;
        let isLoading = false;

        async function loadData(search = '', offset = 0) {
            if (isLoading) return;
            isLoading = true;
            
            try {
                document.getElementById('status').textContent = offset === 0 ? 'Loading...' : 'Loading more...';
                
                const params = new URLSearchParams({
                    limit: '50',
                    offset: offset.toString(),
                    search: search,
                    sort: 'followers_count',
                    order: 'DESC'
                });
                
                const response = await fetch('/api/accounts?' + params.toString());
                const result = await response.json();
                
                if (offset === 0) {
                    allData = result.accounts;
                    document.getElementById('results').innerHTML = '';
                } else {
                    allData.push(...result.accounts);
                }
                
                displayData();
                document.getElementById('status').textContent = 
                    `Showing ${allData.length} of ${result.total} accounts`;
                
                currentOffset = allData.length;
                
            } catch (error) {
                document.getElementById('status').textContent = 'Error: ' + error.message;
                console.error(error);
            } finally {
                isLoading = false;
            }
        }

        function displayData() {
            const html = allData.map(item => `
                <div class="card">
                    <div class="username">@${item.userName}</div>
                    <div class="category">${item.Category}</div>
                    <div class="followers">${item.followersCount.toLocaleString()} followers</div>
                    <div style="margin-top: 10px; color: #666;">${item.Description.substring(0, 200)}...</div>
                </div>
            `).join('');
            document.getElementById('results').innerHTML = html;
        }

        // Search functionality
        let searchTimeout;
        document.getElementById('searchInput').addEventListener('input', (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                currentOffset = 0;
                loadData(e.target.value, 0);
            }, 500);
        });

        // Infinite scroll
        window.addEventListener('scroll', () => {
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 1000) {
                const searchTerm = document.getElementById('searchInput').value;
                loadData(searchTerm, currentOffset);
            }
        });

        // Initial load
        loadData();
    </script>
</body>
</html>
